@model SAT.HR.Models.PositionTransferDetailViewModel

@*<style>
    .bootstrap-select .dropdown-toggle[title="-- กรุณาเลือก --"] .filter-option-inner-inner {
        color: red;
    }
</style>*@

@using (Html.BeginForm(null, null, FormMethod.Post, new { @class = "form-position-transfer" }))
{
    <div class="form-horizontal">
        <div class="row">
            <label class="col-sm-2 col-form-label" for="UserID">พนักงาน:<span class="text-danger"> *</span> </label>
            <div class="col-sm-6">
                @Html.DropDownListFor(n => n.UserID, new SelectList((IEnumerable<SelectListItem>)ViewBag.Employee, "Value", "Text"), "-- กรุณาเลือก --", new { @class = "selectpicker", data_style = "select-with-transition", data_show_subtext = "true", data_live_search = "true", data_size = "5", required = "true" })
            </div>
            @Html.Label("ระดับ: ", null, new { @class = "col-sm-1 col-form-label" })
            <div class="col-sm-2">
                <span class="label-text user-level"></span>
            </div>
        </div>
        <div class="row">
            @Html.Label("ตำแหน่งปัจจุบัน: ", null, new { @class = "col-sm-2 col-form-label" })
            <div class="col-sm-10">
                @Html.Hidden("CurMpID")
                <span class="label-text user-po"></span>
            </div>
        </div>
        <div class="row">
            @Html.Label("ฝ่าย/กอง/งาน: ", null, new { @class = "col-sm-2 col-form-label" })
            <div class="col-sm-10">
                <span class="label-text user-mp"></span>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 ml-auto mr-auto m-t-10 m-b-10 text-left">
                <h5 class="card-title text-primary"><span>ตำแหน่งที่ย้ายไป</span></h5>
            </div>
        </div>
        <div class="row">
            <label class="col-sm-2 col-form-label" for="MovMpID">ย้ายไปตำแหน่ง:<span class="text-danger"> *</span> </label>
            <div class="col-sm-6">
                @Html.DropDownListFor(n => n.MovMpID, new SelectList((IEnumerable<SelectListItem>)ViewBag.Position, "Value", "Text"), "-- กรุณาเลือก --", new { @class = "selectpicker", data_style = "select-with-transition", data_show_subtext = "true", data_live_search = "true", data_size = "5", required = "true" })
            </div>
            <div class="col-sm-4">
                @Html.Label("ผู้ดำรงตำแหน่ง: ", null, new { @class = "col-form-label" })
                <span class="label-text move-name"></span>
            </div>
        </div>
        <div class="row">
            @Html.Label("ฝ่าย/กอง/งาน: ", null, new { @class = "col-sm-2 col-form-label" })
            <div class="col-sm-10">
                <span class="label-text move-mp"></span>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 ml-auto mr-auto m-t-20 m-b-10 text-left">
                <h5 class="card-title  text-primary"><span>รักษาการแทน / ปฏิบัติหน้าที่แทน / ช่วยปฏิบัติงาน</span></h5>
            </div>
        </div>
        <div class="row">
            @Html.Label("ประเภท: ", null, new { @class = "col-sm-2 col-form-label" })
            <div class="col-sm-6">
                @Html.DropDownListFor(n => n.AgentPoTID, new SelectList((IEnumerable<SelectListItem>)ViewBag.PositionType, "Value", "Text"), "-- กรุณาเลือก --", new { @class = "selectpicker", data_style = "select-with-transition", data_show_subtext = "true", data_live_search = "true", data_size = "5" })
            </div>
        </div>
        <div class="row">
            @Html.Label("ตำแหน่ง: ", null, new { @class = "col-sm-2 col-form-label" })

            <div class="col-sm-6">
                @Html.DropDownListFor(n => n.AgentMpID, new SelectList((IEnumerable<SelectListItem>)ViewBag.Position, "Value", "Text"), "-- กรุณาเลือก --", new { @class = "selectpicker", data_style = "select-with-transition", data_show_subtext = "true", data_live_search = "true", data_size = "5" })
            </div>
            <div class="col-sm-4">
                @Html.Label("ผู้ดำรงตำแหน่ง: ", null, new { @class = "col-form-label" })
                <span class="label-text agent-name"></span>
            </div>
        </div>
        <div class="row">
            @Html.Label("ฝ่าย/กอง/งาน: ", null, new { @class = "col-sm-2 col-form-label" })
            <div class="col-sm-10">
                <span class="label-text agent-mp"></span>
            </div>
        </div>
        <div class="row">

        </div>
        <div class="row">
            @Html.Label("หมายเหตุ: ", null, new { @class = "col-sm-2 col-form-label" })
            <div class="col-sm-10">
                @Html.TextBoxFor(m => m.MovRemark, new { @class = "form-control" })
            </div>
        </div>
    </div>
}

<script>

    $('.selectpicker').selectpicker();

    $("#UserID").change(function () {
        var userid = $('#UserID').val();
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDetailByUser", "Master")',
            data: { userid: userid },
            dataType: 'json',
            success: function (res) {
                var manpower = res.ManPower;
                var poname = res.Position;
                var level = res.Level;
                var curmpid = res.MpID;
                $('#CurMpID').val(curmpid);
                $('.user-mp').text(manpower);
                $('.user-po').text(poname);
                $('.user-level').text(level);
            }
        });
    });

    $("#MovMpID").change(function () {
        var mpid = $('#MovMpID').val();
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDetailByMp", "Master")',
            data: { mpid: mpid },
            dataType: 'json',
            success: function (res) {
                var manpower = res.ManPower;
                var username = res.FullNameTh;
                $('.move-mp').text(manpower);
                $('.move-name').text(username);
            }
        });
    });

    $("#AgentMpID").change(function () {
        var mpid = $('#AgentMpID').val();
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDetailByMp", "Master")',
            data: { mpid: mpid },
            dataType: 'json',
            success: function (res) {
                var manpower = res.ManPower;
                var username = res.FullNameTh;
                $('.agent-mp').text(manpower);
                $('.agent-name').text(username);
            }
        });
    });


</script>